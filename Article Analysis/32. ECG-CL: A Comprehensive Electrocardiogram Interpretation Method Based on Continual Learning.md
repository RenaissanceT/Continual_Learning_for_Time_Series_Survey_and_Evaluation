
# [ECG-CL: A Comprehensive Electrocardiogram Interpretation Method Based on Continual Learning](https://arxiv.org/abs/2304.04646)

----

<img width="1366" alt="Screenshot 2025-04-02 at 12 54 02 AM" src="https://github.com/user-attachments/assets/a900778c-ea3a-40d0-9c67-45dd00b6bdfd" />

-----

### Domain-incremental scenario

-----
 
## **研究背景**

针对心电图（ECG）自动化智能解读的需求，提出了一种综合性的多分辨率-持续学习（multi-resolution continual learning, ECG-CL）方法。该算法有效集成了局部形态与全局节律信息，支持分割与分类多任务的持续增量学习，并通过**参数隔离**与**剪枝机制**实现了高效的模型扩展与知识迁移。实验表明，相比传统方法，ECG-CL在多源、多任务、多类别的增量学习场景下有更好的泛化能力及实际应用前景，特别适合可穿戴设备的实时心电智能监测。

![image](https://github.com/user-attachments/assets/77fd7b73-b029-49b8-9c29-00540bdae9b9)

图示：详细说明 ECG 分析的示意图。中间部分说明了标准 ECG 波形的形态和两个连续心跳之间的标准间隔信息。围绕这个中心描述的是各种心律失常的例子。由红色虚线包裹的心律失常表示心律异常，其特征是紧接在它们之前和之后的 RR 间期波动。绿色虚线包裹的不规则性表示形态异常，如 QRS 波群和其他子波的变化所示。两个框的交集突出了节律和形态异常共存的例子


## 论文贡献

1. 我们提出了一种新颖的基于 CNN 的多分辨率模型，旨在在 ECG 解释中保留高分辨率形态语义和低级节律特征。该模型包含一个精心编排的卷积模块，从而有效地执行分类和分割任务。

2. 本文率先将分割和分类任务集成到一个统一的框架中。通过利用从以前的任务中学到的通用特征，该模型可以提高下游任务的性能。此外，该模型培养了特定于任务的特征来解决当前问题，从而为数据可用性有限的数据库提供了可行的解决方案。

3. 使用四个可公开访问的数据库进行大量实验：CPSC 2019、12 导联 QRS、ICBEB 2018 和 PTBXL。结果证明了所提出的 ECG-CL 方法在提供 ECG 信号全面解释方面的有效性。此外，实验证实了该方法在可穿戴设备中的潜在适用性，正如单导联实验的结果所反映的那样

## 算法

在心电图解释的背景下，基于深度学习的 QRS 分割和异常检测可以从持续学习方法中受益。分割通常被视为二元分类问题，在多个数据库中的持续学习有助于识别新的 QRS 形态。分类任务可以看作是一个**类增量场景**，其中集成了各种非统一的数据库，形成了一个全面的异常检测模型。此外，从分段到分类的过渡可以看作是一个**域增量场景**，利用分段功能来完成分类任务。我们的工作利用基于参数隔离的持续学习策略来解决 ECG 分析中的这些情况。

![image](https://github.com/user-attachments/assets/a5a7fc8b-54fe-475d-b121-6ec717a73226)

![image](https://github.com/user-attachments/assets/b4d26509-e52c-4017-86d0-de7b9211a739)

整个 ECG 处理主干包括多分辨率架构 （a） 以及两个用于分割 （a.3） 和分类 （a.4） 的解码器。多分辨率架构分为四个阶段，每个阶段由模块化模块组成。分支分区模块将当前过滤器分成两个分支，一半保留用于当前分辨率，另一半分配给较低的分辨率。在卷积块（两层残差模块）之后，分支合并模块 （a.2） 采用跨步卷积或反卷积方法来集成不同分辨率的特征。ECG 分割需要对低分辨率信息进行插值的高分辨率功能。相反，可以通过逐渐将信息从其他分辨率传输到最低分辨率来对低分辨率特征执行 ECG 分类。

<img width="1600" alt="Screenshot 2025-05-19 at 2 43 22 PM" src="https://github.com/user-attachments/assets/08cf294d-c20d-4d15-abdf-20436b9a9d31" />

该策略的核心是通过剪枝【释放参数空间】、掩码机制【参数隔离】和重复的训练-剪枝-微调环节，实现多任务/多类别的增量持续学习，强化模型在面对不断增加的新任务时，能够：

- 边学新知识，边保留老知识（即避免灾难性遗忘）
  
- 高效利用参数空间，适应设备资源限制

### 核心思路

- **多分辨率特征提取**：模型主干采用多分辨率架构（multi-resolution），能同时提取ECG信号的局部细节和全局趋势，兼顾节律与形态特征。
  
- **持续学习（Continual Learning, CL）**：结合参数隔离和剪枝（pruning），模型能够在无须保留全部历史样本的情况下增量学习新任务而不遗忘旧任务。
  
- **任务分离与知识迁移**：模型结构上将特征提取主干与任务特定解码器分开，主干参数可在相关任务间共享，不同任务（如分割与分类）解码器参数独立，既保证任务独立性，又支持特征迁移。
  
- **三阶段训练（train-compact-retrain）**：每个新任务的学习过程分为训练、裁剪（剪枝）释放部分参数，以及微调恢复性能。此过程可迭代应用于多个任务。

### 具体步骤

1. **第一个任务训练（Task 1）**
   
- 从零训练模型，完成第一个分割或分类任务。

- 对主干及解码器参数按照设定的稀疏度进行剪枝，将部分权重设为“冻结”（不可更新），部分设为“释放”供后续任务使用。

- 对因剪枝损失的性能进行微调补偿。

2. **新任务学习（Task t+1）**
   
- 利用“参数隔离”机制：

  - 沿用主干中保留的通用参数＋释放的新参数。

  - 旧任务参数梯度为零，防止遗忘。

  - 通过mask机制选择可迁移参数，加速新任务学习。

- 重复训练-剪枝-微调，释放部分参数为将来的新任务预留空间。

- 每个任务均拥有独立的掩码（mask）和任务ID，实现推理阶段的快速切换。

## 结论

介绍了一种多分辨率架构作为 ECG 解释任务的基础，以及一种基于参数隔离的持续学习策略。利用这些基本要素，我们设计了几种类型的持续学习实验，包括领**域增量学习**（从分割任务过渡到分类任务）、**任务增量学习**（从基本任务发展到复杂任务）和**类增量学习**（从几个类的任务发展到多个类的任务）。

实验结果表明，我们提出的 ECG-CL 方法明显优于传统的从头开始训练方法。这表明有可能训练**一个能够处理未观察到的数据和独特心脏异常的综合心电图网络**。对单导联数据的进一步实验表明，我们的 AI 算法对智能可穿戴设备具有前瞻性，可实现更彻底的日常监控。






