

# [Regularization-based Continual Learning for Anomaly Detection in Discrete Manufacturing](https://arxiv.org/abs/2101.00509)

----

<img width="1366" alt="Screenshot 2025-04-02 at 1 07 00 AM" src="https://github.com/user-attachments/assets/28ca7972-3021-42b9-a5db-77a4e176b51c" />

-----

## **研究背景**

异常是所有自动化系统中的潜在问题，因为它们对任何控制软件都构成了挑战： 根据定义，它们是传统规则或基于模型的自动化无法解决的问题，即使在数据驱动的系统中，处理它们也很困难，因为它们可能会意外发生，并且可能与以前发生的任何情况有很大不同。

异常检测在离散制造（Discrete Manufacturing）过程中至关重要，能够帮助企业发现故障、提升效率、减少损失。传统异常检测方法多为静态模型，难以适应复杂、动态且数据稀缺的工业环境。深度学习方法（如LSTM等）虽有效，但受限于大量标注数据的需求，且难以适应频繁变动的生产任务。

论文聚焦于利用基于正则化（regularization-based）的持续学习（Continual Learning, CL）算法，解决在增量学习（incremental learning）场景下，模型对序列任务进行“灾难性遗忘（catastrophic forgetting）”的问题，并以实际工业制造时序数据作为实验。对比了不同的正则化型持续学习方法（EWC, Online EWC, SI, LwF），并提出基于多层LSTM为基础的异常检测框架。针对离散制造场景，系统性比较了基于正则化的持续学习方法，在多任务序列中基于LSTM的异常检测器上均可有效缓解灾难遗忘问题。Online EWC表现最优，但在任务序列增长及任务间异质性增强时仍存在性能瓶颈。

## 算法

1. **异常类型**：区分点异常（point anomaly）、群体异常（collective anomaly）、上下文异常（contextual anomaly）。

- 点异常的特征是单个数据实例被视为异常。它们通常是最容易检测的。

- 集体异常的特征是一系列数据实例作为一个组被视为异常，但并非每个单独的数据实例都需要异常。这必然需要各个数据实例之间的关系，例如它们在时间序列数据中的序列。

- 上下文异常的特征是数据仅在特定的、单独定义的上下文中异常。这必然需要描述数据实例上下文的上下文属性。

数据特点：工业数据多为时序且任务多样，需用兼容序列学习的模型（如LSTM）。

![image](https://github.com/user-attachments/assets/9b6b9098-b49f-4f6b-9f70-7b5f55782687)

2. **持续学习**方法通常分为三类：架构方法（Architecture-based）， 排练方法（Rehearsal-based）， 正则化方法（Regularization-based）

在缓解持续学习中的两个关键问题（1.缺数据，2.持续训练）时，这三类方法的有效性存在差异：排练方法仍然依赖于至少部分数据的共享， 架构方法主要适用于处理松散相关的任务， 正则化方法通过修改损失函数处理密切相关任务，更具潜力

3. **持续/增量学习框架**

多层LSTM为基础模型，输入层尺寸为3000，经若干LSTM隐藏层，输出为两节点（正常/异常判断）。正则化持续学习方法通过修改损失函数，对历史任务的关键权重加以约束，防止遗忘。

4. **正则化基方法具体实现**

4.1 **EWC（Elastic Weight Consolidation）**

计算历史任务权重的重要度（Fisher信息矩阵），对重要参数变化加惩罚。

- 损失函数 = 当前任务损失 + 历史任务权重变化正则项。

4.2 **Online EWC**

只保留一份历史参数和整体Fisher信息，主要关注近期任务，节省存储与计算。

4.3 **Synaptic Intelligence（SI）**

在梯度下降过程中动态估算参数重要度，实时加正则。

4.4 **Learning without Forgetting（LwF）**

用旧任务的输出约束新任务训练，间接防止遗忘。

5. **实验**

在实际工业制造过程采集的时序数据上，设置5任务、8任务连续训练实验，对比有无正则化、以及不同方法的性能表现（准确率、遗忘程度等）。

采用Pytorch，批量大小100，LSTM隐藏层数2、每层节点200，学习率0.001等参数。

## 应用

1. 用于设备、产品、产线因工艺变动、产品更新、新旧设备切换时，自动、连续适配异常检测模型。

2. 特别适合数据连续增量积累，无法一次性获得全流程大数据的制造业生产现场。

## 结论

1）与没有正则化相比，正则化方法可以提高我们基本算法的性能。

2）在线弹性权重整合（Online elastic weight consolidation）优于 弹性权重整合（Elastic weight consolidation），学习不忘记（learning without forgetting）和突触智能（synaptic intelligence）。


