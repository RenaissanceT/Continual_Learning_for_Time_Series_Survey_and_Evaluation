# [Bayesian Continual Imputation and Prediction For Irregularly Sampled Time Series Data](https://ieeexplore.ieee.org/document/9746342)

----

<img width="1366" alt="Screenshot 2025-04-02 at 1 10 33 AM" src="https://github.com/user-attachments/assets/f3275a90-f6d5-40d7-aa98-46a948579da6" />

-----

以下是对你提供的论文内容的结构化总结和分析：

---

## 背景

本文提出了一种用于**不规则采样、多变量时间序列数据**的**贝叶斯持续学习数据插补与预测算法（B-CIPIT）**。该方法主要针对在流式、连续多任务学习场景下，数据样本频次不均且存在大量缺失值的现实需求，兼顾（1）对时序数据的缺失值插补，和（2）对下游任务的预测，并（3）支持增量/持续学习，显著缓解灾难性遗忘问题。**B-CIPIT**以贝叶斯LSTM为核心，结合变分推断、具备持续学习能力，实现了对不规则采样时间序列数据的高质量插补与预测，适合多源、增量、缺失强的现实数据场景。

1. 将贝叶斯LSTM与增量持续学习结合，实现了对任务序列的递进学习；

2. 同时优化插补（Imputation）和预测（Prediction）两项任务；

3. 针对不规则采样的时间序列场景，引入时序衰减因子进行动态插补；

4. 利用贝叶斯方法对模型参数不确定性建模，有效防止持续学习中的灾难性遗忘。

## 算法

假设存在一个任务序列，每个任务数据均为多变量、时序且有缺失。目标是设计一种模型，在学习新任务时既能做插补也能做预测，同时最大程度保留已学任务的知识。

### 贝叶斯LSTM建模（Bayes by Backprop）

用贝叶斯LSTM作为主网络，对每个参数w建模为概率分布；

采用变分推断方法，对真实后验 \( P(w \mid D_i) \) 进行近似，优化KL散度 \( KL[q(w|\theta)||P(w|D_i)] \)，

分别包括：
  - 先验P(w)：参数的先验分布
  - 似然P(D|w)：观测数据给定参数的概率
  - 近似后验q(w|θ)：用高斯等分布建模，参数为θ
  - 损失函数包括KL项（正则约束参数变化）和任务损失（插补、预测）

### 插补与预测

对于每个时刻的输入，缺失值通过结合前一时刻隐状态和当前可用特征进行估算（插补函数g，融合时序特征和同一时刻其他变量信息）；

使用掩码矩阵M指示缺失情况，并通过插补和真实数据结合，完成缺失值填充；

分别计算插补损失（MAE）和分类任务损失（交叉熵）。

### 策略

采用递推的贝叶斯推断方式：新任务的参数先验直接取上一个任务的后验分布（即q(W|θ_{i-1})）；

这样模型在新任务中学习时，不会遗忘旧知识，同时能适应新数据；

持续学习训练总损失为：
  \[
  L_{cont} = KL(q(W_r|\theta_i), q(W_r|\theta_{i-1})) + L_{imp}(X, \hat{X}) + L_{pred}(Y, \hat{Y})
  \]

## 应用

(1) **医疗健康**：医院病人监护中，随时间产生的新患者数据批次，各特征信息采集频率不同且常有缺失，用于病情预测/插补；

(2) **IoT/工业**：传感器数据流中特征不规则采样与丢包，需对数据实时插补并进行后续判别；

(3) **金融风险**：多时间粒度财务特征流式产生，异常或缺失需动态插补并对风险进行预测；

(4) **其他需连续接收新任务、不丢失旧知识的、多任务时序数据场景。**

## 结论


